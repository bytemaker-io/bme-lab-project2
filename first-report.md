#第一次汇报

## 拜占庭问题

拜占庭将军问题是一个协议问题，拜占庭帝国军队的将军们必须全体一致的决定是否攻击某一支敌军。问题是这些将军在地理上是分隔开来的，并且将军中存在叛徒。叛徒可以任意行动以达到以下目标：欺骗某些将军采取进攻行动；促成一个不是所有将军都同意的决定，如当将军们不希望进攻时促成进攻行动；或者迷惑某些将军，使他们无法做出决定。如果叛徒达到了这些目的之一，则任何攻击行动的结果都是注定要失败的，只有完全达成一致的努力才能获得胜利

## 共识机制（解决拜占庭问题）

### 1.PoW （依靠算力，谁先算出来符合难度的哈希，谁就获得记账权）
###  2.PoS （质押代币，质押的币越多，影响力越大）


##### (1) PoS并不需要像PoW那样需要庞大的算力才能保障网络安全。Staking指的是ETH持有者通过质押一笔ETH来成为网络的验证者。验证者通过软件客户端运行节点，工作包括确认和验证交易，以及如果被选择了，验证者将在区块链上创建新的块。验证者能否验证新的区块或者交易，取决于各种因素，比如该节点质押了多少的ETH以及质押了多长时间。在PoS共识下，只要有32个ETH，任何人都可以参与运行网络。即便用户不够32个ETH，也可以使用消费级的电脑，加入质押池，参与网络运行。
 
#####  (2)引进：分片链
简单来说，分片链就是可以在以太坊内操作的区块链。现在，每个以太坊节点在处理一笔新的交易之前都要同步整个以太坊区块链的信息。这要比实际需要更多的算力和存储空间。

使用分片，节点可以集中关注一个分片子集，它们只需要同步这些分片的内容。也就是说，通过这种方式，节点不必存储整个以太坊区块链的内容，可以更有效地使用它们的算力，释放出更庞大的网络容量。

#####  (3)引进：信标链
在当前的以太坊网络中只有一条链，每个以太坊节点都与这条单一的链通信。然而，一旦分片上线，主网上就会有许多不同的区块链 (即分片链)，它们相互并行工作着。信标链起支配作用，确保网络中的每个分片同步相同的信息与数据——它为所有分片链提供共识。

如前所述，验证者可以验证交易，并且如果他们被选择，也可以提议新的分片区块。如果没有被选择提议新区块，验证者的工作是确保已被提议的区块无异常——对已提议的分片区块进行验证或证明。

至少需要128名验证者验证每个分片区块，这群验证者组成一个委员会。而提议以及验证每个分片区块的时帧为一个slot。该委员会每次对32个slot进行提议以及验证区块，合起来为一个epoch，之后该委员会将被解散，并将选出一组新的验证者。这样做是为了让恶意验证者无法控制新一组提议区块的最终结果。

当一个提议的分片区块从委员会中获得了足够的证明，交联 (crosslink) 将向信标链共享分片的状态，包括新区块以及其交易数据。

信标链记录着上述全过程的所有事情，给分片区块提议者奖励ETH，并对作恶者进行惩罚 (即罚没)。当区块准备就绪且一切都运行良好时，仍然需要对其进行敲定，以防止作恶者对其进行复原。

信标链区块也被敲定之后，则认为分片区块已被**敲定**。完成此操作之后，其他分片将能够读取与该分片区块相关的数据。




![](https://picture.iczhiku.com/weixin/weixin16260665429012.png)

当矿工质押 32 个 ETH 成为验证节点后，信标链就会通过随机算法来选择验证节点作为出块节点来打包区块，每一个区块都会随机选择一次出块节点。同时在每一个周期 Epoch 中，信标链还会将所有的验证节点平均并随机分配给每个区块一组由至少 128（不确定） 个验证节点组成的**「委员会（Committees）」**。



也就是说每个区块会被分配所有节点数量 32 分之 1 数量的验证节点，这些验证节点组成的「委员会（Committees）」需要对每个区块出块节点打包的区块进行验证投票。当出块节点打包区块后，超过三分之二以上的验证节点投票通过即可成功出块。

![](https://img.foresightnews.pro/202302/8d99742aae807ce5c7328ad3480b559c.png?x-oss-process=style/scale70)

Epochs标志着Finalization的边界。如果超过2/3的网络在一个epoch证实，它就能通过验证。如果第二个epoch紧随第一个epoch同样超过2/3的网络得到验证，这将意味着这个epoch将实现Finalization，并得到以太坊的安全保障。


